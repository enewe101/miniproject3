Put all source code for the advanced method here.
